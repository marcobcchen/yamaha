"use strict";$((function(){var e,a,o,t=!0,l=0,s=0,n=null,p=null,i=$(".map"),c=$(".city");function u(){l=$(window).innerWidth(),s=$(window).innerHeight();var e=2.15*$(".ratio-container").innerHeight();$(".ratio-container").css({width:e}),d()}function d(){var e=l,a=s-(l<992?40:80),o=.5*(e-c.innerWidth()),t=.5*(a-c.innerHeight());i.stop().scrollTo({top:"50%",left:"50%"},800),e>c.innerWidth()?c.css({left:o}):c.css({left:"auto"}),a>c.innerHeight()?c.css({top:t}):c.css({top:"auto"})}function h(e,a){var o=e.data("popup");o&&(a.preventDefault(),$(".popup").toggleClass("open"),"good_home"==o?(TweenMax.set($(".popup-good-home .man-1"),{autoAlpha:0,scale:.5}),TweenMax.set($(".popup-good-home .man-2"),{autoAlpha:0,scale:.5}),TweenMax.set($(".popup-good-home .man-3"),{autoAlpha:0,scale:.5}),TweenMax.set($(".popup-good-home .man-4"),{autoAlpha:0,scale:.5}),TweenMax.set($(".popup-good-home .man-5"),{autoAlpha:0,scale:.5}),TweenMax.set($(".popup-good-home .man-talk"),{autoAlpha:0,scale:.5,y:20}),TweenMax.set($(".popup-good-home .btn-close"),{autoAlpha:0,scale:.5}),TweenMax.to($(".popup-good-home .man-1"),.1,{autoAlpha:1,scale:1,delay:.05,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-2"),.1,{autoAlpha:1,scale:1,delay:.05,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-3"),.1,{autoAlpha:1,scale:1,delay:.07,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-4"),.1,{autoAlpha:1,scale:1,delay:.09,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-5"),.1,{autoAlpha:1,scale:1,delay:.09,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-talk"),.3,{autoAlpha:1,scale:1,y:0,delay:.2,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .btn-close"),.3,{autoAlpha:1,scale:1,delay:.25,ease:Back.easeOut})):(d(),$(".popup-basic .pic").css("display","none"),$(".popup-basic .pic-"+n+"-"+o).css("display","block"),$(".popup-basic .des").css("display","none"),$(".popup-basic .des-"+n+"-"+o).css("display","block"),TweenMax.set($(".popup-basic"),{scale:.5,autoAlpha:0}),TweenMax.to($(".popup-basic"),.5,{scale:1,autoAlpha:1,ease:Back.easeOut,delay:.4})))}function k(){console.log("重設車款：".concat(n,", 車色：").concat(p));for(var o=1;o<=9;o++){var l=$(".bike-road-"+o).data("path");$(".bike-road-"+o+" img").attr("src","images/bike_".concat(n,"_").concat(p,"_").concat(l,".png"))}var s,i;$("header .btn-change-color .pic img").attr("src","images/bike_".concat(n,"_").concat(p,"_t.png")),t&&(t=!1,TweenMax.to($(".building-center"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.1}),TweenMax.to($(".building-school"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.2}),TweenMax.to($(".building-ysp"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.3}),TweenMax.to($(".building-stadium"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.4}),TweenMax.to($(".building-cinemas"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.5}),TweenMax.to($(".building-gas-station"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.6}),TweenMax.to($(".building-mall"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.7}),TweenMax.to($(".building-community"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.8}),TweenMax.to($(".building-street"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.9}),TweenMax.to($(".building-good-home"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:1}),TweenMax.to($(".building-store"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:1.1}),TweenMax.to($(".flag"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:1.3}),TweenMax.to($(".flag-main"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:1.5}),s=.9,(i=new TimelineMax).to($(".bike-road-1"),.5,{y:0,alpha:1,ease:Bounce.easeOut,delay:2}),i.to($(".bike-road-1"),1*s,{left:"42.8%",top:"69.6%",ease:Linear.easeNone}),i.to($(".bike-road-1"),0,{alpha:0}),i.addLabel("restart"),i.addCallback((function(){$(".building-community").css("zIndex",70)})),i.to($(".bike-road-2"),0,{alpha:1}),i.to($(".bike-road-2"),7*s,{left:"61.2%",top:"46.6%",ease:Linear.easeNone}),i.to($(".bike-road-2"),0,{alpha:0}),i.to($(".bike-road-3"),0,{alpha:1}),i.addCallback((function(){a.seek("start").play()})),i.to($(".bike-road-3"),2.5*s,{left:"55.9%",top:"38%",ease:Linear.easeNone}),i.to($(".bike-road-3"),0,{alpha:0}),i.to($(".bike-road-4"),0,{alpha:1}),i.to($(".bike-road-4"),2.5*s,{left:"61.4%",top:"29.2%",ease:Linear.easeNone}),i.to($(".bike-road-4"),0,{alpha:0}),i.to($(".bike-road-5"),0,{alpha:1}),i.to($(".bike-road-5"),1*s,{left:"60.4%",top:"26%",ease:Linear.easeNone}),i.to($(".bike-road-5"),0,{alpha:0}),i.to($(".bike-road-6"),0,{alpha:1}),i.addCallback((function(){e.seek("start").play()})),i.to($(".bike-road-6"),2.5*s,{left:"52.3%",top:"33.8%",ease:Linear.easeNone}),i.to($(".bike-road-6"),0,{alpha:0}),i.to($(".bike-road-7"),0,{alpha:1}),i.to($(".bike-road-7"),1*s,{left:"50.2%",top:"31%",ease:Linear.easeNone}),i.to($(".bike-road-7"),0,{alpha:0}),i.to($(".bike-road-8"),0,{alpha:1}),i.addCallback((function(){$(".farm-house-2").css("zIndex",10)})),i.to($(".bike-road-8"),7*s,{left:"30.5%",top:"53.5%",ease:Linear.easeNone}),i.to($(".bike-road-8"),0,{alpha:0}),i.to($(".bike-road-9"),0,{alpha:1}),i.to($(".bike-road-9"),5*s,{left:"42.8%",top:"69.6%",ease:Linear.easeNone}),i.to($(".bike-road-9"),0,{alpha:0}),i.addCallback((function(){i.seek("restart").play()})))}function r(){$(".select-bike .step-1 li").removeClass("active"),$(".select-bike .step-2 li").removeClass("active"),$(".select-bike .step-1").css("display","flex"),$(".select-bike .step-2").css("display","none"),$(".select-bike .step-2 ul").css("display","none"),TweenMax.set($(".select-bike .select-container"),{scale:.5,autoAlpha:0}),TweenMax.to($(".select-bike .select-container"),.5,{scale:1,autoAlpha:1,ease:Back.easeOut,delay:.4}),TweenMax.to($(".select-bike"),.3,{autoAlpha:1,delay:.1}),o.seek("start").play()}$.html5Loader({filesToLoad:"assets.json",onBeforeLoad:function(){var t;$(window).on("resize",u),u(),function(){function e(){$(".menu").toggleClass("open"),$("nav").toggleClass("open")}$(".menu").on("click",(function(a){a.preventDefault(),e()})),$(".btn-change-color").on("click",(function(a){a.preventDefault(),e(),r()})),$(".navigate a").on("click",(function(a){h($(this),a),e()}))}(),$(".select-bike .step-1 li").on("click",(function(){$(".select-bike .step-1 li").removeClass("active"),$(this).addClass("active")})),$(".select-bike .step-2 li").on("click",(function(){$(".select-bike .step-2 li").removeClass("active"),$(this).addClass("active")})),$(".select-bike .step-1 a").on("click",(function(e){e.preventDefault();var a=$(".select-bike .step-1").find(".active").index();localStorage.setItem("bikeType",a),n=a,a<0?alert("請選擇您的愛車！"):($(".select-bike .step-1").css("display","none"),$(".select-bike .step-2").css("display","flex"),0==a?$(".select-bike .step-2 .color-1").css("display","flex"):$(".select-bike .step-2 .color-2").css("display","flex"))})),$(".select-bike .step-2 a").on("click",(function(e){e.preventDefault();var a=$(".select-bike .step-2").find(".active").index();localStorage.setItem("bikeColor",a),p=a,a<0?alert("請選擇愛車顏色！"):(TweenMax.to($(".select-bike .select-container"),.5,{scale:.5,autoAlpha:0,ease:Back.easeIn}),TweenMax.to($(".select-bike"),.3,{autoAlpha:0,delay:.3}),o.seek("start").pause()),k()})),(o=new TimelineMax({paused:!0})).addLabel("start"),o.fromTo($(".man-talk .man-1"),.3,{alpha:0,y:10},{alpha:1,y:0,ease:Back.easeIn,delay:.5}),o.fromTo($(".man-talk .talk-1"),.6,{alpha:0,x:-10},{alpha:1,x:0,ease:Back.easeOut}),o.to($(".man-talk .man-1"),.3,{alpha:0,y:10,ease:Back.easeIn,delay:2}),o.to($(".man-talk .talk-1"),.3,{alpha:0,x:-10,ease:Back.easeOut,delay:-.3}),o.fromTo($(".man-talk .man-2"),.3,{alpha:0,y:10},{alpha:1,y:0,ease:Back.easeIn}),o.fromTo($(".man-talk .talk-2"),.6,{alpha:0,x:10},{alpha:1,x:0,ease:Back.easeOut}),o.to($(".man-talk .man-2"),.3,{alpha:0,y:10,ease:Back.easeIn,delay:2}),o.to($(".man-talk .talk-2"),.3,{alpha:0,x:10,ease:Back.easeOut,delay:-.3}),o.addCallback((function(){o.seek("start").play()})),TweenMax.set($(".bike-road-1"),{left:"40.6%",top:"67%",y:-10,alpha:0}),TweenMax.set($(".bike-road-2"),{alpha:0}),TweenMax.set($(".bike-road-3"),{alpha:0}),TweenMax.set($(".bike-road-4"),{alpha:0}),TweenMax.set($(".bike-road-5"),{alpha:0}),TweenMax.set($(".bike-road-6"),{alpha:0}),TweenMax.set($(".bike-road-7"),{alpha:0}),TweenMax.set($(".bike-road-8"),{alpha:0}),TweenMax.set($(".bike-road-9"),{alpha:0}),function(){TweenMax.set($(".car-r"),{alpha:0});var a=.8;(e=new TimelineMax({paused:!0})).addLabel("start"),e.to($(".car-l"),10*a,{left:"52.6%",top:"36%",ease:Linear.easeNone}),e.to($(".car-l"),0,{alpha:0}),e.to($(".car-r"),0,{alpha:1}),e.to($(".car-r"),10*a,{left:"79.8%",top:"1.6%",ease:Linear.easeNone})}(),function(){TweenMax.set($(".bus-t"),{alpha:0});var e=1.2;(a=new TimelineMax({paused:!0})).addLabel("start"),a.to($(".bus-r"),6*e,{left:"27%",top:"39.6%",ease:Linear.easeNone}),a.to($(".bus-r"),0,{alpha:0}),a.to($(".bus-t"),0,{alpha:1}),a.addCallback((function(){$(".building-community").css("zIndex",54),$(".farm-house-2").css("zIndex",56)})),a.to($(".bus-t"),16*e,{left:"78.4%",top:"100%",ease:Linear.easeNone})}(),t=20,TweenMax.set($(".building-center"),{autoAlpha:0,y:t}),TweenMax.set($(".building-school"),{autoAlpha:0,y:t}),TweenMax.set($(".building-ysp"),{autoAlpha:0,y:t}),TweenMax.set($(".building-stadium"),{autoAlpha:0,y:t}),TweenMax.set($(".building-cinemas"),{autoAlpha:0,y:t}),TweenMax.set($(".building-gas-station"),{autoAlpha:0,y:t}),TweenMax.set($(".building-mall"),{autoAlpha:0,y:t}),TweenMax.set($(".building-community"),{autoAlpha:0,y:t}),TweenMax.set($(".building-street"),{autoAlpha:0,y:t}),TweenMax.set($(".building-good-home"),{autoAlpha:0,y:t}),TweenMax.set($(".building-store"),{autoAlpha:0,y:t}),TweenMax.set($(".flag"),{autoAlpha:0,y:-50}),TweenMax.set($(".flag-main"),{autoAlpha:0,y:-50}),$(".flag").on("click",(function(e){h($(this),e)})),$(".popup-basic .btn-close").on("click",(function(){TweenMax.to($(".popup-basic"),.5,{scale:.5,autoAlpha:0,ease:Back.easeOut,onComplete:function(){$(".popup").toggleClass("open")}})})),$(".popup-good-home .btn-close").on("click",(function(){TweenMax.to($(".popup-good-home .man-1"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-2"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-3"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-4"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-5"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-talk"),.3,{autoAlpha:0,scale:.5,y:20,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .btn-close"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut,onComplete:function(){$(".popup").toggleClass("open")}})}))},onComplete:function(){TweenMax.to($(".loading"),.5,{autoAlpha:0,delay:1,onComplete:function(){n=localStorage.getItem("bikeType"),p=localStorage.getItem("bikeColor"),console.log("車款：",n),console.log("車色：",p),n&&p?k():r()}})},onElementLoaded:function(e,a){},onUpdate:function(e){console.log(e)}})}));