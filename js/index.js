"use strict";$((function(){var e,a,o=!0,t=0,l=0,s=null,n=null,i=$(".map"),p=$(".city");function c(){t=$(window).innerWidth(),l=$(window).innerHeight();var e=2.15*$(".ratio-container").innerHeight();$(".ratio-container").css({width:e}),u()}function u(){var e=t,a=l-(t<992?40:80),o=.5*(e-p.innerWidth()),s=.5*(a-p.innerHeight());i.stop().scrollTo({top:"50%",left:"50%"},800),e>p.innerWidth()?p.css({left:o}):p.css({left:"auto"}),a>p.innerHeight()?p.css({top:s}):p.css({top:"auto"})}function d(e,a){var o=e.data("popup");o&&(a.preventDefault(),$(".popup").toggleClass("open"),"good_home"==o?(TweenMax.set($(".popup-good-home .man-1"),{autoAlpha:0,scale:.5}),TweenMax.set($(".popup-good-home .man-2"),{autoAlpha:0,scale:.5}),TweenMax.set($(".popup-good-home .man-3"),{autoAlpha:0,scale:.5}),TweenMax.set($(".popup-good-home .man-4"),{autoAlpha:0,scale:.5}),TweenMax.set($(".popup-good-home .man-5"),{autoAlpha:0,scale:.5}),TweenMax.set($(".popup-good-home .man-talk"),{autoAlpha:0,scale:.5,y:20}),TweenMax.set($(".popup-good-home .btn-close"),{autoAlpha:0,scale:.5}),TweenMax.to($(".popup-good-home .man-1"),.1,{autoAlpha:1,scale:1,delay:.05,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-2"),.1,{autoAlpha:1,scale:1,delay:.05,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-3"),.1,{autoAlpha:1,scale:1,delay:.07,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-4"),.1,{autoAlpha:1,scale:1,delay:.09,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-5"),.1,{autoAlpha:1,scale:1,delay:.09,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-talk"),.3,{autoAlpha:1,scale:1,y:0,delay:.2,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .btn-close"),.3,{autoAlpha:1,scale:1,delay:.25,ease:Back.easeOut})):(u(),$(".popup-basic .pic").css("display","none"),$(".popup-basic .pic-"+s+"-"+o).css("display","block"),$(".popup-basic .des").css("display","none"),$(".popup-basic .des-"+s+"-"+o).css("display","block"),TweenMax.set($(".popup-basic"),{scale:.5,autoAlpha:0}),TweenMax.to($(".popup-basic"),.5,{scale:1,autoAlpha:1,ease:Back.easeOut,delay:.4})))}function r(){console.log("重設車款：".concat(s,", 車色：").concat(n));for(var t=1;t<=9;t++){var l=$(".bike-road-"+t).data("path");$(".bike-road-"+t+" img").attr("src","images/bike_".concat(s,"_").concat(n,"_").concat(l,".png"))}var i,p;o&&(o=!1,TweenMax.to($(".building-center"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.1}),TweenMax.to($(".building-school"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.2}),TweenMax.to($(".building-ysp"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.3}),TweenMax.to($(".building-stadium"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.4}),TweenMax.to($(".building-cinemas"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.5}),TweenMax.to($(".building-gas-station"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.6}),TweenMax.to($(".building-mall"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.7}),TweenMax.to($(".building-community"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.8}),TweenMax.to($(".building-street"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.9}),TweenMax.to($(".building-good-home"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:1}),TweenMax.to($(".building-store"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:1.1}),TweenMax.to($(".flag"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:1.3}),TweenMax.to($(".flag-main"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:1.5}),i=.6,(p=new TimelineMax).to($(".bike-road-1"),.5,{y:0,alpha:1,ease:Bounce.easeOut,delay:2}),p.to($(".bike-road-1"),1*i,{left:"42.6%",top:"69.6%",ease:Linear.easeNone}),p.to($(".bike-road-1"),0,{alpha:0}),p.addLabel("restart"),p.to($(".bike-road-2"),0,{alpha:1}),p.to($(".bike-road-2"),7*i,{left:"61.6%",top:"46.6%",ease:Linear.easeNone}),p.to($(".bike-road-2"),0,{alpha:0}),p.to($(".bike-road-3"),0,{alpha:1}),p.addCallback((function(){a.seek("start").play()})),p.to($(".bike-road-3"),2.5*i,{left:"55.5%",top:"38%",ease:Linear.easeNone}),p.to($(".bike-road-3"),0,{alpha:0}),p.to($(".bike-road-4"),0,{alpha:1}),p.to($(".bike-road-4"),2.5*i,{left:"61.8%",top:"29.2%",ease:Linear.easeNone}),p.to($(".bike-road-4"),0,{alpha:0}),p.to($(".bike-road-5"),0,{alpha:1}),p.to($(".bike-road-5"),1*i,{left:"60%",top:"26%",ease:Linear.easeNone}),p.to($(".bike-road-5"),0,{alpha:0}),p.to($(".bike-road-6"),0,{alpha:1}),p.addCallback((function(){e.seek("start").play()})),p.to($(".bike-road-6"),2.5*i,{left:"52.8%",top:"34%",ease:Linear.easeNone}),p.to($(".bike-road-6"),0,{alpha:0}),p.to($(".bike-road-7"),0,{alpha:1}),p.to($(".bike-road-7"),1*i,{left:"49.8%",top:"31%",ease:Linear.easeNone}),p.to($(".bike-road-7"),0,{alpha:0}),p.to($(".bike-road-8"),0,{alpha:1}),p.addCallback((function(){$(".farm-house-2").css("zIndex",10)})),p.to($(".bike-road-8"),7*i,{left:"30.9%",top:"53.9%",ease:Linear.easeNone}),p.to($(".bike-road-8"),0,{alpha:0}),p.to($(".bike-road-9"),0,{alpha:1}),p.to($(".bike-road-9"),5*i,{left:"42.6%",top:"69.6%",ease:Linear.easeNone}),p.to($(".bike-road-9"),0,{alpha:0}),p.addCallback((function(){p.seek("restart").play()})))}function h(){$(".select-bike .step-1 li").removeClass("active"),$(".select-bike .step-2 li").removeClass("active"),$(".select-bike .step-1").css("display","flex"),$(".select-bike .step-2").css("display","none"),$(".select-bike .step-2 ul").css("display","none"),TweenMax.set($(".select-bike .select-container"),{scale:.5,autoAlpha:0}),TweenMax.to($(".select-bike .select-container"),.5,{scale:1,autoAlpha:1,ease:Back.easeOut,delay:.4}),TweenMax.to($(".select-bike"),.3,{autoAlpha:1,delay:.1})}$.html5Loader({filesToLoad:"assets.json",onBeforeLoad:function(){var o;$(window).on("resize",c),c(),function(){function e(){$(".menu").toggleClass("open"),$("nav").toggleClass("open")}$(".menu").on("click",(function(a){a.preventDefault(),e()})),$(".logo").on("click",(function(e){e.preventDefault(),localStorage.clear()})),$(".btn-change-color").on("click",(function(a){a.preventDefault(),e(),h()})),$(".navigate a").on("click",(function(a){d($(this),a),e()}))}(),$(".select-bike .step-1 li").on("click",(function(){$(".select-bike .step-1 li").removeClass("active"),$(this).addClass("active")})),$(".select-bike .step-2 li").on("click",(function(){$(".select-bike .step-2 li").removeClass("active"),$(this).addClass("active")})),$(".select-bike .step-1 a").on("click",(function(e){e.preventDefault();var a=$(".select-bike .step-1").find(".active").index();localStorage.setItem("bikeType",a),s=a,a<0?alert("請選擇您的愛車！"):($(".select-bike .step-1").css("display","none"),$(".select-bike .step-2").css("display","flex"),$(".select-bike .talk-1").css("display","none"),$(".select-bike .talk-2").css("display","block"),0==a?$(".select-bike .step-2 .color-1").css("display","flex"):$(".select-bike .step-2 .color-2").css("display","flex"))})),$(".select-bike .step-2 a").on("click",(function(e){e.preventDefault();var a=$(".select-bike .step-2").find(".active").index();localStorage.setItem("bikeColor",a),n=a,a<0?alert("請選擇愛車顏色！"):(TweenMax.to($(".select-bike .select-container"),.5,{scale:.5,autoAlpha:0,ease:Back.easeIn}),TweenMax.to($(".select-bike"),.3,{autoAlpha:0,delay:.3})),r()})),TweenMax.set($(".bike-road-1"),{left:"40.6%",top:"67%",y:-10,alpha:0}),TweenMax.set($(".bike-road-2"),{alpha:0}),TweenMax.set($(".bike-road-3"),{alpha:0}),TweenMax.set($(".bike-road-4"),{alpha:0}),TweenMax.set($(".bike-road-5"),{alpha:0}),TweenMax.set($(".bike-road-6"),{alpha:0}),TweenMax.set($(".bike-road-7"),{alpha:0}),TweenMax.set($(".bike-road-8"),{alpha:0}),TweenMax.set($(".bike-road-9"),{alpha:0}),function(){TweenMax.set($(".car-r"),{alpha:0});var a=.8;(e=new TimelineMax({paused:!0})).addLabel("start"),e.to($(".car-l"),5*a,{left:"52.6%",top:"36%",ease:Linear.easeNone}),e.to($(".car-l"),0,{alpha:0}),e.to($(".car-r"),0,{alpha:1}),e.to($(".car-r"),5*a,{left:"79.8%",top:"1.6%",ease:Linear.easeNone})}(),function(){TweenMax.set($(".bus-t"),{alpha:0});var e=.8;(a=new TimelineMax({paused:!0})).addLabel("start"),a.to($(".bus-r"),3*e,{left:"27%",top:"39.6%",ease:Linear.easeNone}),a.to($(".bus-r"),0,{alpha:0}),a.to($(".bus-t"),0,{alpha:1}),a.addCallback((function(){$(".building-community").css("zIndex",54),$(".farm-house-2").css("zIndex",56)})),a.to($(".bus-t"),10*e,{left:"78.8%",top:"100%",ease:Linear.easeNone}),a.addCallback((function(){$(".building-community").css("zIndex",70)}))}(),o=20,TweenMax.set($(".building-center"),{autoAlpha:0,y:o}),TweenMax.set($(".building-school"),{autoAlpha:0,y:o}),TweenMax.set($(".building-ysp"),{autoAlpha:0,y:o}),TweenMax.set($(".building-stadium"),{autoAlpha:0,y:o}),TweenMax.set($(".building-cinemas"),{autoAlpha:0,y:o}),TweenMax.set($(".building-gas-station"),{autoAlpha:0,y:o}),TweenMax.set($(".building-mall"),{autoAlpha:0,y:o}),TweenMax.set($(".building-community"),{autoAlpha:0,y:o}),TweenMax.set($(".building-street"),{autoAlpha:0,y:o}),TweenMax.set($(".building-good-home"),{autoAlpha:0,y:o}),TweenMax.set($(".building-store"),{autoAlpha:0,y:o}),TweenMax.set($(".flag"),{autoAlpha:0,y:-50}),TweenMax.set($(".flag-main"),{autoAlpha:0,y:-50}),$(".flag").on("click",(function(e){d($(this),e)})),$(".popup-basic .btn-close").on("click",(function(){TweenMax.to($(".popup-basic"),.5,{scale:.5,autoAlpha:0,ease:Back.easeOut,onComplete:function(){$(".popup").toggleClass("open")}})})),$(".popup-good-home .btn-close").on("click",(function(){TweenMax.to($(".popup-good-home .man-1"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-2"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-3"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-4"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-5"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-talk"),.3,{autoAlpha:0,scale:.5,y:20,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .btn-close"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut,onComplete:function(){$(".popup").toggleClass("open")}})}))},onComplete:function(){TweenMax.to($(".loading"),1,{autoAlpha:0,delay:1,onComplete:function(){s=localStorage.getItem("bikeType"),n=localStorage.getItem("bikeColor"),console.log("車款：",s),console.log("車色：",n),s&&n?r():h()}})},onElementLoaded:function(e,a){},onUpdate:function(e){console.log(e)}})}));