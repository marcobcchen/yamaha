"use strict";$((function(){var e,a,o,t,l,s=!0,n=0,p=0,i=null,c=null,u=$(".map"),d=$(".city");function r(){n=$(window).innerWidth(),p=$(window).innerHeight();var e=2.15*$(".ratio-container").innerHeight();$(".ratio-container").css({width:e}),h()}function h(){var e=n,a=p-(n<992?40:80),o=.5*(e-d.innerWidth()),t=.5*(a-d.innerHeight());u.stop().scrollTo({top:"50%",left:"50%"},800),e>d.innerWidth()?d.css({left:o}):d.css({left:"auto"}),a>d.innerHeight()?d.css({top:t}):d.css({top:"auto"})}function k(e,a){var o=e.data("popup");o&&(a.preventDefault(),console.log(o,$(".popup").hasClass("open")),$(".popup").hasClass("open")?$(".popup").removeClass("open"):$(".popup").addClass("open"),"good_home"==o?(TweenMax.set($(".popup-good-home .man-1"),{autoAlpha:0,scale:.5}),TweenMax.set($(".popup-good-home .man-2"),{autoAlpha:0,scale:.5}),TweenMax.set($(".popup-good-home .man-3"),{autoAlpha:0,scale:.5}),TweenMax.set($(".popup-good-home .man-4"),{autoAlpha:0,scale:.5}),TweenMax.set($(".popup-good-home .man-5"),{autoAlpha:0,scale:.5}),TweenMax.set($(".popup-good-home .man-talk"),{autoAlpha:0,scale:.5,y:20}),TweenMax.set($(".popup-good-home .btn-close"),{autoAlpha:0,scale:.5}),TweenMax.to($(".popup-good-home .man-1"),.1,{autoAlpha:1,scale:1,delay:.05,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-2"),.1,{autoAlpha:1,scale:1,delay:.05,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-3"),.1,{autoAlpha:1,scale:1,delay:.07,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-4"),.1,{autoAlpha:1,scale:1,delay:.09,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-5"),.1,{autoAlpha:1,scale:1,delay:.09,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-talk"),.3,{autoAlpha:1,scale:1,y:0,delay:.2,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .btn-close"),.3,{autoAlpha:1,scale:1,delay:.25,ease:Back.easeOut})):(h(),$(".popup-basic").removeClass("school mall stadium"),$(".popup-basic").addClass(o),$(".popup-basic .pic").css("display","none"),$(".popup-basic .pic-"+i+"-"+o).css("display","block"),$(".popup-basic .des").css("display","none"),$(".popup-basic .des-"+i+"-"+o).css("display","block"),TweenMax.set($(".popup-basic"),{scale:.5,autoAlpha:0}),TweenMax.to($(".popup-basic"),.5,{scale:1,autoAlpha:1,ease:Back.easeOut,delay:.4})))}function b(){console.log("重設車款：".concat(i,", 車色：").concat(c));for(var l=1;l<=9;l++){var n=$(".bike-road-"+l).data("path");$(".bike-road-"+l+" img").attr("src","images/bike_".concat(i,"_").concat(c,"_").concat(n,".png"))}var p,u;$("header .btn-change-color .pic img").attr("src","images/bike_".concat(i,"_").concat(c,"_t.png")),s&&(s=!1,TweenMax.fromTo($(".cloud-1"),50,{x:2e3,y:1200},{x:-2e3,y:-1200,repeat:-1,delay:.5}),TweenMax.fromTo($(".cloud-2"),60,{x:2e3,y:1200},{x:-2e3,y:-1200,repeat:-1,delay:1}),TweenMax.fromTo($(".cloud-3"),60,{x:2e3,y:1200},{x:-2e3,y:-1200,repeat:-1,delay:1.5}),TweenMax.fromTo($(".cloud-4"),70,{x:2e3,y:1200},{x:-2e3,y:-1200,repeat:-1,delay:1}),TweenMax.fromTo($(".cloud-5"),60,{x:2e3,y:1200},{x:-2e3,y:-1200,repeat:-1,delay:30}),TweenMax.fromTo($(".cloud-6"),70,{x:2e3,y:1200},{x:-2e3,y:-1200,repeat:-1,delay:20}),TweenMax.to($(".building-center"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.1}),TweenMax.to($(".building-school"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.2}),TweenMax.to($(".building-ysp"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.3}),TweenMax.to($(".building-stadium"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.4}),TweenMax.to($(".building-cinemas"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.5}),TweenMax.to($(".building-gas-station"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.6}),TweenMax.to($(".building-mall"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.7}),TweenMax.to($(".building-community"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.8}),TweenMax.to($(".building-street"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:.9}),TweenMax.to($(".building-good-home"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:1}),TweenMax.to($(".building-store"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:1.1}),TweenMax.to($(".people"),.6,{autoAlpha:1,ease:Back.easeOut,delay:1.2}),TweenMax.to($(".flag"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:1.3}),TweenMax.to($(".flag-main"),.6,{autoAlpha:1,y:0,ease:Back.easeOut,delay:1.5}),p=.9,(u=new TimelineMax).to($(".bike-road-1"),.5,{y:0,alpha:1,ease:Bounce.easeOut,delay:2}),u.to($(".bike-road-1"),1*p,{left:"42.8%",top:"69.6%",ease:Linear.easeNone}),u.to($(".bike-road-1"),0,{alpha:0}),u.addLabel("restart"),u.addCallback((function(){$(".building-community").css("zIndex",70),a.seek("start").play(),t.seek("start").play()})),u.to($(".bike-road-2"),0,{alpha:1}),u.to($(".bike-road-2"),7*p,{left:"61.2%",top:"46.6%",ease:Linear.easeNone}),u.to($(".bike-road-2"),0,{alpha:0}),u.to($(".bike-road-3"),0,{alpha:1}),u.addCallback((function(){o.seek("start").play()})),u.to($(".bike-road-3"),2.5*p,{left:"55.9%",top:"38%",ease:Linear.easeNone}),u.to($(".bike-road-3"),0,{alpha:0}),u.to($(".bike-road-4"),0,{alpha:1}),u.to($(".bike-road-4"),2.5*p,{left:"61.4%",top:"29.2%",ease:Linear.easeNone}),u.to($(".bike-road-4"),0,{alpha:0}),u.to($(".bike-road-5"),0,{alpha:1}),u.to($(".bike-road-5"),1*p,{left:"60.4%",top:"26%",ease:Linear.easeNone}),u.to($(".bike-road-5"),0,{alpha:0}),u.to($(".bike-road-6"),0,{alpha:1}),u.addCallback((function(){e.seek("start").play()})),u.to($(".bike-road-6"),2.5*p,{left:"52.3%",top:"33.8%",ease:Linear.easeNone}),u.to($(".bike-road-6"),0,{alpha:0}),u.to($(".bike-road-7"),0,{alpha:1}),u.to($(".bike-road-7"),1*p,{left:"50.2%",top:"31%",ease:Linear.easeNone}),u.addCallback((function(){})),u.to($(".bike-road-7"),0,{alpha:0}),u.to($(".bike-road-8"),0,{alpha:1}),u.addCallback((function(){$(".farm-house-2").css("zIndex",10)})),u.to($(".bike-road-8"),7*p,{left:"30.5%",top:"53.5%",ease:Linear.easeNone}),u.to($(".bike-road-8"),0,{alpha:0}),u.to($(".bike-road-9"),0,{alpha:1}),u.to($(".bike-road-9"),5*p,{left:"42.8%",top:"69.6%",ease:Linear.easeNone}),u.to($(".bike-road-9"),0,{alpha:0}),u.addCallback((function(){u.seek("restart").play()})))}function x(){$(".select-bike .step-1 li").removeClass("active"),$(".select-bike .step-2 li").removeClass("active"),$(".select-bike .step-1").css("display","flex"),$(".select-bike .step-2").css("display","none"),$(".select-bike .step-3").css("display","none"),$(".select-bike .step-2 ul").css("display","none"),TweenMax.set($(".select-bike .select-container"),{scale:.5,autoAlpha:0}),TweenMax.to($(".select-bike .select-container"),.5,{scale:1,autoAlpha:1,ease:Back.easeOut,delay:.4}),TweenMax.to($(".select-bike"),.3,{autoAlpha:1,delay:.1}),l.seek("start").play()}function y(){TweenMax.to($(".popup-basic"),.5,{scale:.5,autoAlpha:0,ease:Back.easeOut,onComplete:function(){$(".popup").removeClass("open")}})}function m(){TweenMax.to($(".popup-good-home .man-1"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-2"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-3"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-4"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-5"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .man-talk"),.3,{autoAlpha:0,scale:.5,y:20,ease:Back.easeOut}),TweenMax.to($(".popup-good-home .btn-close"),.3,{autoAlpha:0,scale:.5,ease:Back.easeOut,onComplete:function(){$(".popup").removeClass("open")}})}$.html5Loader({filesToLoad:"assets.json",onBeforeLoad:function(){var s;$(window).on("resize",r),r(),function(){function e(){$(".menu").toggleClass("open"),$("nav").toggleClass("open")}$(".menu").on("click",(function(a){a.preventDefault(),e(),y(),m()})),$(".btn-change-color").on("click",(function(a){a.preventDefault(),e(),x()})),$(".navigate a").on("click",(function(a){k($(this),a),e()}))}(),$(".select-bike .step-1 li").on("click",(function(){$(".select-bike .step-1 li").removeClass("active"),$(this).addClass("active")})),$(".select-bike .step-2 li").on("click",(function(){$(".select-bike .step-2 li").removeClass("active"),$(this).addClass("active")})),$(".select-bike .step-1 a").on("click",(function(e){e.preventDefault();var a=$(".select-bike .step-1").find(".active").index();localStorage.setItem("bikeType",a),i=a,a<0?alert("請選擇您的愛車！"):($(".select-bike .step-1").css("display","none"),$(".select-bike .step-2").css("display","flex"),0==a?$(".select-bike .step-2 .color-1").css("display","flex"):$(".select-bike .step-2 .color-2").css("display","flex"))})),$(".select-bike .step-2 a").on("click",(function(e){e.preventDefault();var a=$(".select-bike .step-2").find(".active").index();localStorage.setItem("bikeColor",a),c=a,a<0?alert("請選擇愛車顏色！"):($(".select-bike .step-2").css("display","none"),$(".select-bike .step-3").css("display","flex"))})),$(".select-bike .step-3 a").on("click",(function(e){e.preventDefault(),TweenMax.to($(".select-bike .select-container"),.5,{scale:.5,autoAlpha:0,ease:Back.easeIn}),TweenMax.to($(".select-bike"),.3,{autoAlpha:0,delay:.3}),l.seek("start").pause(),b()})),(l=new TimelineMax({paused:!0})).addLabel("start"),l.fromTo($(".man-talk .man-1"),.3,{alpha:0,y:10},{alpha:1,y:0,ease:Back.easeIn,delay:.5}),l.fromTo($(".man-talk .talk-1"),.6,{alpha:0,x:-10},{alpha:1,x:0,ease:Back.easeOut}),l.to($(".man-talk .man-1"),.3,{alpha:0,y:10,ease:Back.easeIn,delay:2}),l.to($(".man-talk .talk-1"),.3,{alpha:0,x:-10,ease:Back.easeOut,delay:-.3}),l.fromTo($(".man-talk .man-2"),.3,{alpha:0,y:10},{alpha:1,y:0,ease:Back.easeIn}),l.fromTo($(".man-talk .talk-2"),.6,{alpha:0,x:10},{alpha:1,x:0,ease:Back.easeOut}),l.to($(".man-talk .man-2"),.3,{alpha:0,y:10,ease:Back.easeIn,delay:2}),l.to($(".man-talk .talk-2"),.3,{alpha:0,x:10,ease:Back.easeOut,delay:-.3}),l.addCallback((function(){l.seek("start").play()})),TweenMax.set($(".bike-road-1"),{left:"40.6%",top:"67%",y:-10,alpha:0}),TweenMax.set($(".bike-road-2"),{alpha:0}),TweenMax.set($(".bike-road-3"),{alpha:0}),TweenMax.set($(".bike-road-4"),{alpha:0}),TweenMax.set($(".bike-road-5"),{alpha:0}),TweenMax.set($(".bike-road-6"),{alpha:0}),TweenMax.set($(".bike-road-7"),{alpha:0}),TweenMax.set($(".bike-road-8"),{alpha:0}),TweenMax.set($(".bike-road-9"),{alpha:0}),function(){TweenMax.set($(".car-r"),{alpha:0}),TweenMax.set($(".car2-l"),{alpha:0}),TweenMax.set($(".car2-r"),{alpha:0}),TweenMax.set($(".car2-t"),{alpha:0});var o=.8;e=new TimelineMax({paused:!0}),a=new TimelineMax({paused:!0}),e.addLabel("start"),e.to($(".car-l"),10*o,{left:"52.6%",top:"36%",ease:Linear.easeNone}),e.to($(".car-l"),0,{alpha:0}),e.to($(".car-r"),0,{alpha:1}),e.to($(".car-r"),10*o,{left:"79.8%",top:"1.6%",ease:Linear.easeNone}),a.addLabel("start"),a.to($(".car2-l"),0,{alpha:1}),a.to($(".car2-l"),4*o,{left:"54.6%",top:"71%",ease:Linear.easeNone}),a.to($(".car2-l"),0,{alpha:0}),a.to($(".car2-r"),0,{alpha:1}),a.to($(".car2-r"),5*o,{left:"67.1%",top:"56%",ease:Linear.easeNone}),a.to($(".car2-r"),0,{alpha:0}),a.to($(".car2-t"),0,{alpha:1}),a.to($(".car2-t"),4*o,{left:"78.8%",top:"68.6%",ease:Linear.easeNone})}(),function(){TweenMax.set($(".bus-t"),{alpha:0}),TweenMax.set($(".bus2-t"),{alpha:0}),TweenMax.set($(".bus2-b"),{alpha:0});var e=1.2;o=new TimelineMax({paused:!0}),t=new TimelineMax({paused:!0}),o.addLabel("start"),o.to($(".bus-r"),6*e,{left:"27%",top:"39.6%",ease:Linear.easeNone}),o.to($(".bus-r"),0,{alpha:0}),o.to($(".bus-t"),0,{alpha:1}),o.addCallback((function(){$(".building-community").css("zIndex",54),$(".farm-house-2").css("zIndex",56)})),o.to($(".bus-t"),13.5*e,{left:"78.4%",top:"100%",ease:Linear.easeNone}),t.addLabel("start"),t.to($(".bus2-r"),5*e,{left:"28.8%",top:"55%",ease:Linear.easeNone}),t.to($(".bus2-r"),0,{alpha:0}),t.to($(".bus2-t"),0,{alpha:1}),t.to($(".bus2-t"),6*e,{left:"51%",top:"80.5%",ease:Linear.easeNone}),t.to($(".bus2-t"),0,{alpha:0}),t.to($(".bus2-b"),0,{alpha:1}),t.to($(".bus2-b"),6*e,{left:"36.8%",top:"101.4%",ease:Linear.easeNone})}(),s=20,TweenMax.set($(".building-center"),{autoAlpha:0,y:s}),TweenMax.set($(".building-school"),{autoAlpha:0,y:s}),TweenMax.set($(".building-ysp"),{autoAlpha:0,y:s}),TweenMax.set($(".building-stadium"),{autoAlpha:0,y:s}),TweenMax.set($(".building-cinemas"),{autoAlpha:0,y:s}),TweenMax.set($(".building-gas-station"),{autoAlpha:0,y:s}),TweenMax.set($(".building-mall"),{autoAlpha:0,y:s}),TweenMax.set($(".building-community"),{autoAlpha:0,y:s}),TweenMax.set($(".building-street"),{autoAlpha:0,y:s}),TweenMax.set($(".building-good-home"),{autoAlpha:0,y:s}),TweenMax.set($(".building-store"),{autoAlpha:0,y:s}),TweenMax.set($(".flag"),{autoAlpha:0,y:-50}),TweenMax.set($(".flag-main"),{autoAlpha:0,y:-50}),TweenMax.set($(".cloud-1"),{x:2e3,y:1200}),TweenMax.set($(".cloud-2"),{x:2e3,y:1200}),TweenMax.set($(".cloud-3"),{x:2e3,y:1200}),TweenMax.set($(".cloud-4"),{x:2e3,y:1200}),TweenMax.set($(".cloud-5"),{x:2e3,y:1200}),TweenMax.set($(".cloud-6"),{x:2e3,y:1200}),$(".flag").on("click",(function(e){k($(this),e)})),$(".popup-basic .btn-close").on("click",(function(){y()})),$(".popup").on("click",(function(){m(),y()}))},onComplete:function(){TweenMax.to($(".loading"),.5,{autoAlpha:0,delay:1,onComplete:function(){i=localStorage.getItem("bikeType"),c=localStorage.getItem("bikeColor"),console.log("車款：",i),console.log("車色：",c),i&&c?b():x()}})},onElementLoaded:function(e,a){},onUpdate:function(e){console.log(e)}})}));